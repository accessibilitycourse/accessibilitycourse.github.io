<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>project7</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <style>
  img {
  border: 2px solid #CCC;
  margin: 2em !important;
  }
  body {
  padding: 5em 1em !important;
  }
  </style>
  <style type="text/css">
  .lst-kix_21pnktrgq2bt-4>li:before{content:"\0025cb  "}.lst-kix_21pnktrgq2bt-6>li:before{content:"\0025cf  "}.lst-kix_21pnktrgq2bt-1>li:before{content:"\0025cb  "}.lst-kix_21pnktrgq2bt-5>li:before{content:"\0025a0  "}.lst-kix_21pnktrgq2bt-0>li:before{content:"\0025cf  "}.lst-kix_21pnktrgq2bt-8>li:before{content:"\0025a0  "}ul.lst-kix_21pnktrgq2bt-1{list-style-type:none}ul.lst-kix_21pnktrgq2bt-2{list-style-type:none}ul.lst-kix_21pnktrgq2bt-0{list-style-type:none}.lst-kix_21pnktrgq2bt-7>li:before{content:"\0025cb  "}ul.lst-kix_21pnktrgq2bt-5{list-style-type:none}ul.lst-kix_21pnktrgq2bt-6{list-style-type:none}ul.lst-kix_21pnktrgq2bt-3{list-style-type:none}ul.lst-kix_21pnktrgq2bt-4{list-style-type:none}ul.lst-kix_21pnktrgq2bt-7{list-style-type:none}ul.lst-kix_21pnktrgq2bt-8{list-style-type:none}.lst-kix_21pnktrgq2bt-2>li:before{content:"\0025a0  "}.lst-kix_21pnktrgq2bt-3>li:before{content:"\0025cf  "}ol{margin:0;padding:0}table td,table th{padding:0}.c2{margin-left:36pt;padding-top:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c14{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:18pt;font-family:"Arial";font-style:normal}.c4{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:italic}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Arial";font-style:normal}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Courier New";font-style:normal}.c3{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c7{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;text-align:left}.c9{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;text-align:left}.c17{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c10{color:#1155cc;text-decoration:underline}.c15{color:inherit;text-decoration:inherit}.c12{padding:0;margin:0}.c11{font-weight:400;font-family:"Courier New"}.c8{margin-left:36pt}.c13{font-style:italic}.c6{height:11pt}.c16{color:#ff0000}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}
  </style>
</head>
<body>
  <div>
    <ul>
      <a href="/">Home</a>:: <a href="/syllabus.html">Syllabus</a>
    </ul>
  </div>
  <div class="maincontent">
    <p class="c7 title" id="h.pa3nzyasjf4j"><span>Project 7: &#160;Single Button Input</span></p>
    <p class="c3"><span class="c13">Due: Tuesday, November 14th &#160;*</span><span class="c13 c16">in class</span><span class="c4">*</span></p>
    <p class="c3 c6"><span class="c4"></span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span class="c5">In this project, you will build a Chrome extension that will enable the user to browse the web only by pressing a single key on their keyboard. This sounds impossible, but it&#8217;s not!</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span>Here&#8217;s the</span> <span class="c10"><a class="c15" href="/projects/project7/scanbar-inclass.html">Example We Built In Class</a></span><span>.</span></p>
    <h2 class="c9" id="h.1ffj6rg7qp1w"><span class="c1">Yet Another Chrome Extension</span></h2>
    <p class="c3"><span class="c5">The basis for this project will be a Chrome extension. To get started, copy and paste the extension that you built for a prior project. Enter its manifest to have a different name. I suggest something like, &#8220;Single Button Input,&#8221; and then load it into the browser.</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <h2 class="c9" id="h.e1d6vnhhk4ik"><span class="c1">Scan bars to select items on the page</span></h2>
    <p class="c3"><span class="c5">The core of this project is two scan lines that will allow your users to select and click on something on the screen. When the user first presses the button, the first scan line should appear going from left to right. When the user presses the button again, the horizontal (x) location should be recorded, and then a new line should appear going from top to bottom. You should keep the vertical line on the screen. When the user hits the button again, the vertical (y) location should be recorded, and then a click should be triggered at that location, and then the scan bars should be removed.</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span class="c5">The bars themselves can just be DIV elements styled to be the width (or height) of the page, with a corresponding thickness set to a few pixels in either the width or height. Set their CSS position to static so that they are always on the screen when you want them to be.</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span>One of the trickiest parts of this section is getting the bars to animate. We&#8217;re going to handle the animation/paint loop manually. First, create the loop using the following:<br>
    <br></span> <span class="c0">setInterval(function() {</span></p>
    <p class="c3"><span class="c0">&#160; paint();</span></p>
    <p class="c3"><span class="c0">}, 200);</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span>This will cause a function that you will define called</span> <span class="c11">paint</span><span>&#160;to be called every 200 milliseconds.<br>
    <br>
    In this function, you&#8217;ll check what state the system is in, and take an appropriate action based on that. Roughly, you&#8217;ll have three states, which are</span> <span class="c11">horizontal_scanning</span><span>,</span> <span class="c11">vertical_scanning</span><span>, and</span> <span class="c11">none</span><span class="c5">. You can set and check the state using a global variable.</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span class="c5">This will look something like the following:<br></span></p>
    <p class="c3"><span class="c0">var state = &#8220;none&#8221; // horizontal_scanning, vertical_scanning</span></p>
    <p class="c3"><span class="c0"><br>
    function paint() {</span></p>
    <p class="c3"><span class="c0">&#160; if(state == &#8220;horizontal_scanning&#8221;) {<br>
    &#160; &#160;// update position of your horizontal scan bar</span></p>
    <p class="c3"><span class="c0">&#160; } else if(state == &#8220;vertical_scanning&#8221;) {</span></p>
    <p class="c3"><span class="c0">&#160; &#160; // update position of your vertical scan bar</span></p>
    <p class="c3"><span class="c0">&#160; } else {</span></p>
    <p class="c3"><span class="c0">&#160; &#160; // do nothing</span></p>
    <p class="c3"><span class="c0">&#160; }</span></p>
    <p class="c3"><span class="c0">}</span></p>
    <p class="c3 c6"><span class="c0"></span></p>
    <p class="c3"><span class="c0">$(document).keydown(function(e) {</span></p>
    <p class="c3"><span class="c0">&#160; if(e.key == &#8220; &#8220;) {</span></p>
    <p class="c3"><span class="c0">&#160; &#160; // update state here, given current state</span></p>
    <p class="c3"><span class="c0">&#160; &#160;</span></p>
    <p class="c3"><span class="c0">&#160; &#160; $(e).stopPropagation();</span></p>
    <p class="c3"><span class="c0">&#160; &#160; return false;</span></p>
    <p class="c3"><span class="c0">&#160; }</span></p>
    <p class="c3"><span class="c0">});</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <h2 class="c9" id="h.kzb6im6jys5a"><span class="c1">Triggering a &#8220;click&#8221; using the scan bars</span></h2>
    <p class="c3"><span class="c5">Once an x and y location has been selected using the scan bars, you can trigger a click at that location using the following code:<br></span></p>
    <p class="c3"><span class="c0">var elementtoclick = document.elementFromPoint(x, y);</span></p>
    <p class="c3"><span class="c0">simulateClick(elementtoclick);</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span class="c0">function simulateClick(element) {</span></p>
    <p class="c3"><span class="c0">&#160; if (!element) return;</span></p>
    <p class="c3"><span class="c0">&#160; var dispatchEvent = function (elt, name) {</span></p>
    <p class="c3"><span class="c0">&#160; &#160; var clickEvent = document.createEvent('MouseEvents');</span></p>
    <p class="c3"><span class="c0">&#160; &#160; clickEvent.initEvent(name, true, true);</span></p>
    <p class="c3"><span class="c0">&#160; &#160; elt.dispatchEvent(clickEvent);</span></p>
    <p class="c3"><span class="c0">&#160; };</span></p>
    <p class="c3"><span class="c0">&#160; dispatchEvent(element, 'mouseover');</span></p>
    <p class="c3"><span class="c0">&#160; dispatchEvent(element, 'mousedown');</span></p>
    <p class="c3"><span class="c0">&#160; dispatchEvent(element, 'click');</span></p>
    <p class="c3"><span class="c0">&#160; dispatchEvent(element, 'mouseup');</span></p>
    <p class="c3"><span class="c0">};</span></p>
    <p class="c3 c6"><span class="c5"><br></span></p>
    <p class="c3"><span>One trick here is that your x and y locations are relative to the window, not the document. You can calculate the appropriate x,y locations for the document by factoring in the current scroll of the page,</span> <span class="c13">i.e.</span><span class="c5">, scrollTop.</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span class="c11">$(document).scrollTop()</span></p>
    <h2 class="c9" id="h.iob6nzlxlf6z"><span class="c1">Enabling the page to be scrolled</span></h2>
    <p class="c3"><span class="c5">You&#8217;ll add new buttons to the document that will allow the user to scroll up and down. These can just be DIVs that have been styled to be square, position static, location in the lower right of the page, with a high z-index so they always appear on the top of everything else.</span></p>
    <p class="c3"><span class="c5"><br>
    When the user clicks them (with the scan bar approach, or just with the mouse), the page should scroll up or down by 10% of the page height. You&#8217;ll find that it&#8217;s much more usable if you animate this scrolling, which jQuery allows you to do, with the following:</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span class="c0">$('html, body').animate({</span></p>
    <p class="c3"><span class="c0">&#160; &#160; scrollTop: $(document).scrollTop()+150</span></p>
    <p class="c3"><span class="c0">&#160;}, 1000);</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span class="c5">In this example, the page will scroll 150px from the current position.</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <h2 class="c9" id="h.s453oqv4bxa0"><span class="c1">Adding a software keyboard</span></h2>
    <p class="c3"><span class="c5">Now you can navigate the web with just your single switch, but how will you enter text? &#160;You&#8217;ll solve that problem now by inserting a software keyboard into the page.</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span>The HTML and CSS for a keyboard is here:<br></span><span class="c10"><a class="c15" href="/projects/project7/keyboard.html">http://accessibilitycourse.com/projects/project7/keyboard.html</a></span></p>
    <p class="c3"><span class="c10"><a class="c15" href="/projects/project7/keyboard.css">http://accessibilitycourse.com/projects/project7/keyboard.css</a></span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span class="c5">When users press a button, you&#8217;ll show the keyboard. Then when users click on the software keyboard with the scanning clicker, you&#8217;ll enter that key in the most recently focused textbox.</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <h2 class="c9" id="h.ynnvhh3u0esz"><span>Triggering keys and entering the text into a form field</span></h2>
    <p class="c3"><span class="c5">When users press a key on the software keyboard, you should alter the contents of the text field so that the character represented by the key is appended to the contents of that field.<br>
    <br>
    One trick to getting this to work is that your program will need to keep track of which input element keys should be sent to. To do this, record the last input element that accepts textual input to be clicked on. When the user types something using the software keyboard, you&#8217;ll add the letter to the field.</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span class="c5">If you consider the code for clicking on an element from above,</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3 c8"><span class="c11">var</span> <span class="c11">elementtoclick</span><span class="c0">&#160;= document.elementFromPoint(x, y);</span></p>
    <p class="c3 c8"><span class="c11">simulateClick(elementtoclick);</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span>you&#8217;ll notice that you have access to the element that was clicked on after the first line (</span><span class="c11">elementtoclick</span><span>). To check if is an element that you should record as being the last one to accept text, you can use the jQuery</span> <span class="c10 c11">is</span><span class="c5">&#160;function, which will be something like this:</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span class="c0">$(elementtoclick).is(&#8220;input[type=&#8217;text&#8217;],textarea&#8221;)</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <p class="c3"><span>This will return true only if the checked element is either a</span> <span class="c11">&lt;input type=&#8221;text&#8221;&gt;</span><span>&#160;or</span> <span class="c11">&lt;textarea&gt;</span><span class="c5">.</span></p>
    <p class="c3 c6"><span class="c0"></span></p>
    <p class="c3"><span>Then when the user simulates a key on the software keyboard, figure out what character should be added, and then append it to whatever is already in the textbox. You can detect a click on the keyboard by either assigning a click event handler to each key, or by simply detecting the code where you simulate a click that this is your keyboard and so it should be handled specially.<br>
    <br>
    You can append the character with something like this, where</span> <span class="c11">newchar</span><span>&#160;should be set to the value of the key, most likely by calling the jQuery</span> <span class="c11">text()</span><span>&#160;function on the element that was clicked.<br>
    <br></span> <span class="c11">v</span><span class="c0">ar newchar = &#8230;;</span></p>
    <p class="c3"><span class="c0">$(elem).val($(elem).val() + newchar);</span></p>
    <p class="c3 c6"><span class="c0"></span></p>
    <p class="c3"><span>CAPS LOCK is a special key that changes the mode of the keyboard. If the CAPS LOCK key has been pressed, then all characters should be made into capital letters. If you have the lowercase version of a character, you can make it into an uppercase version of the character using</span> <span class="c11">.toUpperCase()</span><span>. Keep track of what caps mode you&#8217;re in with another global variable.</span></p>
    <p class="c3 c6"><span class="c5"></span></p>
    <h2 class="c9" id="h.ky69dwrhvesw"><span class="c1">Grading</span></h2>
    <p class="c3"><span class="c5">Main components of our grading will be:<br></span></p>
    <p class="c3"><span class="c5">Using the appropriate keyboard commands, does the following happen:</span></p>
    <ul class="c12 lst-kix_21pnktrgq2bt-0 start">
      <li class="c2"><span class="c5">Scan bars start to cross the page, first from left to right, then from top to bottom</span></li>
      <li class="c2"><span class="c5">An item can be clicked using the scan bars and a single key</span></li>
      <li class="c2"><span class="c5">The page can be scrolled using buttons that are added onto the page</span></li>
      <li class="c2"><span class="c5">A software keyboard can be invoked using a button added to the page</span></li>
      <li class="c2"><span class="c5">Keys can be entered into the most recently focused element using the software keyboard</span></li>
      <li class="c2"><span class="c5">The backspace can be triggered to remove the last character in the current form field</span></li>
      <li class="c2"><span class="c5">The software CAPS LOCK key can be triggered to enter a caps mode<br></span></li>
    </ul>
  </div>
  <div style="height: 30px;"></div>
  <hr>
  <p><span>This page and contents are copyright Jeffrey P. Bigham except where noted.<br></span></p>
</body>
</html>
